## Безопасный маршрут (задача от РЖД, «Цифровой прорыв», 2023, г. Хабаровск)

**Разработчик:** Команда "Деревяшки"

### Описание задачи
При движении моторвагонного подвижного состава имеют место случаи выхода на маршрут следования людей, попадания посторонних предметов на железнодорожные пути или выезд автотранспорта. В таких ситуациях без преувеличения важна каждая секунда, и, если локомотивная бригада не принимает оперативных мер по причине отвлечения от контроля маршрута следования, может произойти трагедия. Аналогичные требования относятся и ко времени реагирования на случаи следования на «красный» сигнал светофора. Своевременное реагирование в данных ситуациях - это спасённые жизни и предотвращение случаев нарушения безопасности движения. 

### Задача участников
Создать систему контроля за состоянием пути, наличия посторонних лиц, предметов на железнодорожном полотне, препятствующих свободному следованию подвижного состава, приближающихся транспортных средств. Система должна анализировать видеопоток постоянно и при выявлении людей или посторонних предметов иметь возможность послать сигнал на устройство световой и звуковой индикации.

### Решение
Решение: 
1. Преобработка видео (OpenCV)
2. Выделение интересующих зон на видео для поиска объектов 
3. Детекция объектов в выделенной зоне (YOLO v8)
4. Постобработка ситуаций определение событий (группировка детекций) 

![dfg](media/demo.gif)
- Поиск объектов при помощи YOLO8 в определенных областях видеопотока
- Разметка областей в видеоряде
- Детекция объектов в размеченных областях

**Модуль по работе с моделью:** [model.py](model.py)  
**Ноутбук с решением:** [baseline_rzhd_yolo8.ipynb](baseline_rzhd_yolo8.ipynb)

Используемые библиотеки:
- ultralytics
- opencv-python
- pandas
- numpy

### Использованные данные
В работе использовались обезличенные данные от РЖД:
- `train_dataset_Безопасный маршрут`

### Установка
`pip install ultralytics`  
`pip install opencv-python`      
`pip install pandas`  
`pip install numpy` 


### Пример запуска 